<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ajax (asynchronous javascript and XML)</title>
</head>

<body>
    <h3>Ajax (asynchronous javascript and XML)</h3>
    <p>AJAX helps in fetching data asynchronously without interfering with the existing page</p>
    <p>this is not a programming language</p>
    <p>no page reload</p>
    <p>better user experience</p>
    <p>very intractive</p>
    <p>saves network bandwithd</p>
    <p>AJAX uses XMLHttpRequest objects also called xhr object
    </p>
    <button type="button" id="fetchBtn">FetchBtn</button>
    <div id="xhrContent"></div>
</body>
<script>

    // xhr GET request method 
    let fetchBtn = document.getElementById("fetchBtn");
    fetchBtn.addEventListener("click", function () {

        // initiate an xhr object
        const xhr = new XMLHttpRequest();

        // open the object
        // get request
        // xhr.open('GET', 'xhr.txt', true);


        // post request to send data
        xhr.open('GET','http://dummy.restapiexample.com/api/v1/employees',true);
        xhr.getResponseHeader('content-type','application/json');
        // xhr.open("GET", "https://coronavirus-smartable.p.rapidapi.com/stats/v1/US/");
        // xhr.setRequestHeader("x-rapidapi-key", "51ac676a75msh0c2bcc36b8d00f4p10effejsna5365e550c3a");
        // xhr.setRequestHeader("x-rapidapi-host", "coronavirus-smartable.p.rapidapi.com");

        // what to do on progress
        xhr.onprogress = function () {
            console.log("On loading")
            fetchBtn.innerText = "on loading"
        }

        // on readyStateChange this is old method
        // xhr.onreadystatechange = function(){
        //     console.log("ready state is ", xhr.readyState);
        // }
        
        // after process/load where you want to use this
        xhr.onload = function () {

            // let xhrContent = document.getElementById("xhrContent");
            // xhrContent.innerHTML =  `<p>${this.responseText}</p>` 
              if(this.status === 200){
                  console.log(this.responseText);
                //   fetchBtn.innerText = "FetchBtn"
                }
                else{
                    console.error("some error occoured")
                }
        }
           
        let data =` {"name": "asisaaf","salary":"123456","age":"20" } `
        xhr.send(data);
    })
                    

</script>

</html>